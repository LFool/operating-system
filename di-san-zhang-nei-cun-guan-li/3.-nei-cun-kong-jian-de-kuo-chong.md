# 3. 内存空间的扩充

## 1. 覆盖技术

覆盖技术用来解决程序大小超过物理内存总和问题

**思想：**将程序分为多个段（多个模块），常用的段常驻内存，不常用的段在需要时调入内存

内存中分为一个**固定区**和**若干个覆盖区**。把要**常驻内存段**放在固定区，**调入后就不再调出**（除非运行结束）；**不常用的段**放在覆盖区，**需要用到时调入内存，用不到时调出内存**

![](../.gitbook/assets/image%20%2868%29.png)

其中 A 一直运行，A 会调用 B 或 C（不会同时调用），B 会调用 D，C 会调用 E 或 F（不会同时调用）。可知 B、C 不可能同时进入内存，D、E、F 不可能同时进入内存，所以开辟两个覆盖区即可（节约内存）

**必须由程序员声明覆盖结构**，操作系统完成自动覆盖。**缺点：**对用户不透明，增加了用户编程负担

## 2. 交换技术

**思想：**内存空间紧张时，系统将内存中某些进程暂时**换出**外存（[**挂起**](../di-er-zhang-jin-cheng-guan-li/6.-jin-cheng-de-tiao-du.md#22-zhong-ji-tiao-du)），把外存中某些已具备运行条件的进程**换入**内存（进程在内存与磁盘间动态调度）

**三个问题：**

1. 被换出的进程应该保存在外存（磁盘）的什么位置？
   * 磁盘存储空间分为**对换区 & 文件区**
   * **文件区：采用离散分配方式，存放文件（主要追求磁盘空间的利用率）**
   * **对换区：采用连续分配方式，存放换出进程的数据（主要追求换出换入速度）**
   * **对换区的 I/O 速度比文件区更快**
2. 什么时候应该换出？
   * 许多内存运行且内存吃紧时进行，而系统负荷降低就停止
3. 应该换出哪些进程？
   * 优先换出**阻塞进程**
   * 优先换出**优先级低的进程**
   * 有的系统还会考虑**驻留时间**

**注意：PCB 会常驻内存，不会被换出内存，换出的仅仅是进程的数据部分**

## 3. 虚拟存储技术

### 3.1 传统存储管理方式的特征、缺点

* **一次性：作业必须一次性全部装入内存后才能开始运行**
  * 作业很大时，不能全部装入内存，导致**大作业无法运行**
  * 当大量作业要求运行时，由于内存无法容纳所有的作业，因此只有少量作业能运行，导致**多道程序并发度下降**
* **驻留性：**一旦作业被装入内存，就**会一直驻留内存中**，直至作业运行结束
  * 事实上，在一个时间段内，只需要访问作业的一小部分数据即可正常运行

### 3.2 虚拟内存的定义和特征

基于局部性原理，在程序装入时，可以将程序中**很快用到的部分装入内存，暂时用不到的部分留在外存**，就可以让程序开始执行

在程序执行过程中，当所访问的**信息不在内存时**，由**操作系统负责将所需要的信息从外存调入内存**，然后继续执行程序

若内存空间不够时，由**操作系统负责**将内存中**暂时用不到的信息换出到外存**

在操作系统的管理下，在用户看来似乎有一个比实际内存大得多的内存，这就是**虚拟内存**

**特点：**

1. **多次性：**无需在作业运行时一次性全部装入内存，而是运行被分为多次调入内存
2. **兑换性**：在作业运行时无需一直常驻内存，而是允许在作业运行过程中，将作业换入、换出
3. **虚拟性：**从逻辑上扩充了内存的容量，使用户看到的内存容量，远大于实际容量

### 3.3 实现虚拟内存技术

在传统的非连续分配存储管理的方式下进行改进：[**请求分页存储管理**](3.-nei-cun-kong-jian-de-kuo-chong.md#4-qing-qiu-fen-ye-guan-li-fang-shi)**、请求分段存储管理、请求段页式存储管理**

**主要区别：**在程序执行过程中，当所**访问的信息不再内存时，由操作系统负责将所需要信息从外存调入内存**，然后继续执行程序。若内存空间不够，由操作系统负责**将内存中暂时用不到的信息换出到外存**

## 4. 请求分页管理方式

